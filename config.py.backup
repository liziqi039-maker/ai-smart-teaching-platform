"""
配置文件 - 修复版本
"""
import os
from pathlib import Path

# 项目根目录
BASE_DIR = Path(__file__).parent.parent

class Config:
    """基础配置"""
    SECRET_KEY = os.getenv('SECRET_KEY', 'ai-teaching-platform-secret-key-change-in-production')
    DEBUG = True
    
    # 数据库配置 - 使用实际的文件数据库
    SQLALCHEMY_DATABASE_URI = f'sqlite:///{BASE_DIR / "database" / "ai_teaching.db"}'
    SQLALCHEMY_TRACK_MODIFICATIONS = False
    
    # JWT配置
    JWT_SECRET_KEY = os.getenv('JWT_SECRET_KEY', 'jwt-secret-key-change-in-production')
    JWT_ACCESS_TOKEN_EXPIRES = 3600  # 1小时
    
    # 上传配置
    UPLOAD_FOLDER = BASE_DIR / 'backend' / 'static' / 'uploads'
    MAX_CONTENT_LENGTH = 16 * 1024 * 1024  # 16MB
    
    # CORS配置
    CORS_ORIGINS = ['http://localhost:3000', 'http://localhost:8080']
    
    # 后端服务配置
    BACKEND_HOST = '0.0.0.0'
    BACKEND_PORT = 8000
    
    # AI服务配置
    AI_SERVICE_URL = 'http://localhost:3001/api/v1/ai'


class DevelopmentConfig(Config):
    """开发环境配置"""
    DEBUG = True


class TestingConfig(Config):
    """测试环境配置"""
    TESTING = True
    SQLALCHEMY_DATABASE_URI = 'sqlite:///:memory:'


class ProductionConfig(Config):
    """生产环境配置"""
    DEBUG = False
    SECRET_KEY = os.getenv('SECRET_KEY')
    JWT_SECRET_KEY = os.getenv('JWT_SECRET_KEY')


# 配置字典
config = {
    'development': DevelopmentConfig,
    'testing': TestingConfig,
    'production': ProductionConfig,
    'default': DevelopmentConfig
}